<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bruh-Spam</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Prism for syntax highlighting -->
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet" />

  <!-- Optional: Prism dark theme (used when dark mode enabled) -->
  <link id="prism-dark" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.css" rel="stylesheet" disabled />

  <!-- Fira Code for code blocks -->
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">

  <!-- Your custom CSS -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container">
    <a class="navbar-brand text-primary" href="#">Bruh-Spam</a>

    <div class="d-flex align-items-center gap-2">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="theme-toggle">
        <label class="form-check-label small" for="theme-toggle">Dark</label>
      </div>
    </div>
  </div>
</nav>

<header class="py-5 bg-dark text-white">
  <div class="container text-center">
    <img src="../logo1.png" alt="logo" class="hero-logo" >
    <h1 class="display-6">Bruh-Spam — ML Spam Classifier</h1>
    <p class="lead">An ML-powered email spam detection system — backend (Render), frontend (Vercel), Gmail Add-on.</p>

    <div class="mt-3">
      <a href="https://bruh-spam.onrender.com" class="btn btn-primary btn-sm me-2" target="_blank">Live Backend</a>
      <a href="https://bruh-spam.vercel.app/" class="btn btn-outline-light btn-sm me-2" target="_blank">Live Frontend</a>
      <a href="https://github.com/AksShri2004/bruh-spam" class="btn btn-secondary btn-sm" target="_blank">GitHub Repo</a>
    </div>

    <div class="mt-3">
      <img src="https://img.shields.io/badge/License-MIT-green.svg" alt="MIT">
      <img src="https://img.shields.io/badge/Python-3.10-blue.svg" alt="Python">
      <img src="https://img.shields.io/badge/Flask-API-black.svg" alt="Flask">
      <img src="https://img.shields.io/badge/Frontend-Vercel-lightgrey.svg" alt="Vercel">
      <img src="https://img.shields.io/badge/Backend-Render-blue.svg" alt="Render">
    </div>
  </div>
</header>

<main class="container my-5">
  <!-- ABOUT -->
  <section class="mb-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <h3 class="card-title text-primary">About</h3>
        <p class="card-text">Bruh-Spam is an advanced, ML-powered email spam classification system built to be fast, accurate, and developer-friendly. It offers a complete ecosystem including:</p>
        <ul>
          <li>A Python/Flask backend microservice for spam prediction</li>
          <li>A clean and intuitive frontend interface for manual testing</li>
          <li>A Gmail Add-on that lets users check any email inside their inbox</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Product -->
  <section class="mb-4">
    <div class="row g-3">
      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-body">
            <h4 class="text-primary">Backend Microservice</h4>
            <p>Flask API with a <code>/predict</code> endpoint deployed on Render.</p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-body">
            <h4 class="text-primary">Gmail Add-on & Frontend</h4>
            <p>Gmail Add-on implemented in Apps Script & frontend hosted on Vercel for manual testing.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Gmail add-on with screenshots -->
  <section class="mb-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <h3 class="text-primary">Gmail Add-on</h3>
        <p>Extracts subject + snippet, sends to microservice, returns analysis and allows labeling as <code>Model-Spam</code> / <code>Model-Not-Spam</code>.</p>

        <div class="row">
          <div class="col-md-6 mb-3">
            <figure class="figure">
              <img src="../1.jpg" class="figure-img img-fluid rounded" alt="addon view">
              <figcaption class="figure-caption">Add-on: message fetching view</figcaption>
            </figure>
          </div>
          <div class="col-md-6 mb-3">
            <figure class="figure">
              <img src="../2.jpg" class="figure-img img-fluid rounded" alt="addon result">
              <figcaption class="figure-caption">Add-on: result view</figcaption>
            </figure>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Frontend screenshots -->
  <section class="mb-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <h3 class="text-primary">Frontend Website</h3>
        <p>Live demo: <a href="https://bruh-spam.vercel.app/" target="_blank">https://bruh-spam.vercel.app/</a></p>

        <div class="row">
          <div class="col-md-6 mb-3">
            <img src="../notspam.jpg" class="img-fluid rounded" alt="not spam">
            <p class="small text-muted mt-1">Not Spam result</p>
          </div>
          <div class="col-md-6 mb-3">
            <img src="../spam.jpg" class="img-fluid rounded" alt="spam">
            <p class="small text-muted mt-1">Spam result</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- API integration + interactive code -->
  <section class="mb-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <h3 class="text-primary">API Integration</h3>

        <h6 class="mt-3">Endpoint</h6>
        <pre class="rounded p-3 code-block"><code class="language-bash">POST https://bruh-spam.onrender.com/predict</code></pre>

        <h6>Headers</h6>
        <pre class="rounded p-3 code-block"><code class="language-bash">Content-Type: application/json
x-api-key: YOUR_API_KEY</code></pre>

        <h6>Body</h6>
        <pre class="rounded p-3 code-block"><code class="language-json">{
  "email_text": "your email text here"
}</code></pre>

        <hr>

        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0">Example — choose language & copy</h5>

          <!-- MOVED: language selector now here -->
          <div class="d-flex gap-2 align-items-center">
            <select id="lang-select" class="form-select form-select-sm">
              <option value="python">Python</option>
              <option value="node">Node.js</option>
              <option value="browser">Browser (fetch)</option>
              <option value="apps-script">Apps Script</option>
            </select>
            <button class="btn btn-sm btn-outline-secondary" id="copy-current">Copy shown</button>
          </div>
        </div>

        <!-- Code snippets (Prism highlighting) -->
        <div class="mt-3">

          <pre class="snippet language-python" id="code-python"><code class="language-python">import requests

API_URL = "https://bruh-spam.onrender.com/predict"
API_KEY = "YOUR_KEY"

payload = {"email_text": "Congratulations! You've won a prize!"}

headers = {
    "x-api-key": API_KEY,
    "Content-Type": "application/json"
}

resp = requests.post(API_URL, json=payload, headers=headers)
print(resp.status_code, resp.json())</code></pre>

          <pre class="snippet language-javascript d-none" id="code-node"><code class="language-javascript">// Node.js (require node-fetch)
const fetch = require("node-fetch");

const API_URL = "https://bruh-spam.onrender.com/predict";
const API_KEY = "YOUR_KEY";

async function checkSpam(text) {
  const res = await fetch(API_URL, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "x-api-key": API_KEY
    },
    body: JSON.stringify({ email_text: text })
  });

  console.log(await res.json());
}

checkSpam("Get rich quick!");</code></pre>

          <pre class="snippet language-javascript d-none" id="code-browser"><code class="language-javascript">// Browser fetch (CORS must be enabled)
fetch("https://bruh-spam.onrender.com/predict", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "x-api-key": "YOUR_KEY"
  },
  body: JSON.stringify({ email_text: "browser test email" })
})
  .then(res => res.json())
  .then(console.log);</code></pre>

          <pre class="snippet language-javascript d-none" id="code-apps-script"><code class="language-javascript">// Google Apps Script (Gmail Add-on)
const API_URL = "https://bruh-spam.onrender.com/predict";
const API_KEY = PropertiesService.getScriptProperties().getProperty("API_KEY");

function callModel(text) {
  const res = UrlFetchApp.fetch(API_URL, {
    method: "post",
    contentType: "application/json",
    payload: JSON.stringify({ email_text: text }),
    headers: { "x-api-key": API_KEY },
    muteHttpExceptions: true
  });

  return JSON.parse(res.getContentText());
}</code></pre>

        </div>
      </div>
    </div>
  </section>

  <!-- Request API Key - Google Form Embed -->
<!-- Request API Key — Accordion + auto-resize (best-effort) -->
<section class="mb-5">
  <div class="accordion" id="apiRequestAccordion">
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingForm">
        <button class="accordion-button collapsed" type="button"
                data-bs-toggle="collapse" data-bs-target="#collapseForm"
                aria-expanded="false" aria-controls="collapseForm">
          Request an API Key
        </button>
      </h2>

      <div id="collapseForm" class="accordion-collapse collapse" aria-labelledby="headingForm" data-bs-parent="#apiRequestAccordion">
        <div class="accordion-body">
          <p class="text-muted mb-3">
            Fill out the form below to request access to the Bruh-Spam API. The form will open inside this panel.
          </p>

          <div class="form-embed-wrapper">
            <iframe 
              id="gform-iframe"
              src="https://docs.google.com/forms/d/e/1FAIpQLSexu5LiVRCMNtMSsdERaOD_mbo6gW7na7-QU-vh6v1lQVnMIA/viewform?embedded=true"
              width="100%" 
              height="800" 
              frameborder="0" 
              marginheight="0" 
              marginwidth="0" 
              style="border-radius:10px; border:1px solid rgba(255,255,255,0.06);"
              title="Bruh-Spam API Request Form"
            >Loading…</iframe>
          </div>

          <p class="small text-muted mt-2">
            Note: if the form appears clipped, open it in a new tab using the "Open in new tab" button in the accordion or the link below.
            <br>
            <a href="https://forms.gle/your_short_form_link" target="_blank" rel="noopener">Open the full form in a new tab</a>
          </p>
        </div>
      </div>
    </div>
  </div>
</section>



  <!-- Troubleshooting / Local dev / Contributing / License / Contact -->
  <section class="mb-4 row">
    <div class="col-md-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h4 class="text-primary">Troubleshooting</h4>
          <ul>
            <li><strong>401 Unauthorized</strong> — API key missing or incorrect</li>
            <li><strong>500 Internal Server Error</strong> — missing model files or python version mismatch</li>
            <li><strong>CORS</strong> — use server-to-server requests in production</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h4 class="text-primary">Local Development</h4>
          <pre class="language-bash"><code>cd backend
docker build -t bruh-backend .
docker run -p 5000:5000 --env API_KEY=your_key bruh-backend

cd frontend
npm install
npm run dev</code></pre>
        </div>
      </div>
    </div>
  </section>

  <section class="mb-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <h4 class="text-primary">Contributing & License</h4>
        <p>Pull requests welcome. Do not commit private keys or secrets.</p>
        <p class="mb-0"><strong>License:</strong> MIT</p>
      </div>
    </div>
  </section>

  <section class="mb-4 text-center">
    <a href="mailto:aksmelittle@gmail.com" class="btn btn-link">Contact: aksmelittle@gmail.com</a>
  </section>
</main>

<footer class="py-4 bg-light text-center">
  <div class="container">
    <small class="text-muted">© 2025 Bruh-Spam — Machine Learning Spam Detection</small>
  </div>
</footer>

<!-- Bootstrap JS (bundle includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Prism JS -->
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>

<script>
  // Theme toggle & Prism dark handling
  const themeToggle = document.getElementById('theme-toggle');
  const prismDark = document.getElementById('prism-dark');

  function setTheme(isDark) {
    if (isDark) {
      document.documentElement.classList.add('dark-mode');
      themeToggle.checked = true;
      prismDark.disabled = false;
      localStorage.setItem('bruh_theme', 'dark');
    } else {
      document.documentElement.classList.remove('dark-mode');
      themeToggle.checked = false;
      prismDark.disabled = true;
      localStorage.setItem('bruh_theme', 'light');
    }
  }

  const savedTheme = localStorage.getItem('bruh_theme') || 'dark';
  setTheme(savedTheme === 'dark');
  themeToggle.addEventListener('change', () => setTheme(themeToggle.checked));

  // Language selector moved into card (initialized here)
  const langSelect = document.getElementById('lang-select');

  function showSnippet(lang) {
    const mapping = {
      python: 'code-python',
      node: 'code-node',
      browser: 'code-browser',
      'apps-script': 'code-apps-script'
    };
    document.querySelectorAll('.snippet').forEach(el => el.classList.add('d-none'));
    const id = mapping[lang];
    if (id) {
      document.getElementById(id).classList.remove('d-none');
      Prism.highlightElement(document.getElementById(id).querySelector('code'));
    }
  }

  showSnippet(langSelect.value);
  langSelect.addEventListener('change', (e) => showSnippet(e.target.value));

  // Copy shown snippet
  document.getElementById('copy-current').addEventListener('click', async () => {
    const visible = document.querySelector('.snippet:not(.d-none)');
    if (!visible) return;
    const text = visible.innerText;
    try {
      await navigator.clipboard.writeText(text);
      const btn = document.getElementById('copy-current');
      btn.textContent = 'Copied ✓';
      setTimeout(() => btn.textContent = 'Copy shown', 1200);
    } catch (err) {
      alert('Copy failed — try manually selecting the code.');
    }
  });
</script>
</body>
</html>
